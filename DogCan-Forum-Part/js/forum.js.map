{"version":3,"sources":["manager.js","category.js","list.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"forum.js","sourcesContent":["window.DogCan = window.DogCan || {};\r\nwindow.DogCan.Forum = window.DogCan.Forum || {};\r\n\r\nwindow.DogCan.Forum.Manager = function (opts_in) {\r\n    var that = this;\r\n    var html = {};\r\n\r\n    // component\r\n    var category = null;\r\n    var list = null;\r\n\r\n    var initList = function (topic) {\r\n        list.loadData(topic);\r\n    };\r\n\r\n    // setup\r\n    var setupHtml = function () {\r\n        html['header'] = $('.block-header');\r\n        html['category'] = $('.block-category');\r\n        html['list'] = $('.block-list');\r\n        html['listLoading'] = $('.block-list .topicLoading');\r\n    };\r\n\r\n    var setupComponent = function () {\r\n        category = new DogCan.Forum.Category();\r\n        list = new DogCan.Forum.List();\r\n    };\r\n\r\n    var setupLayout = function () {\r\n        $$.scroll.set(html['category'][0], 200, function () {\r\n            html['header'].addClass('small_');\r\n        }, $$.scroll.REFERENCE.TOP, $$.scroll.DIRECTION.DOWN);\r\n\r\n        $$.scroll.set(html['category'][0], 200, function () {\r\n            html['header'].removeClass('small_');\r\n        }, $$.scroll.REFERENCE.TOP, $$.scroll.DIRECTION.UP);\r\n\r\n        $$.scroll.set(html['listLoading'][0], 20, function () {\r\n            list && list.load();\r\n        }, $$.scroll.REFERENCE.BOTTOM, $$.scroll.DIRECTION.DOWN);\r\n    };\r\n\r\n    var _init = function (opts) {\r\n        setupHtml();\r\n        setupLayout();\r\n        setupComponent();\r\n\r\n        if (opts == null) return;\r\n        initList(opts.topic);\r\n    };\r\n    _init(opts_in);\r\n};","window.DogCan = window.DogCan || {};\r\nwindow.DogCan.Forum = window.DogCan.Forum || {};\r\n\r\n// manage forum category\r\nwindow.DogCan.Forum.Category = function () {\r\n    var that = this;\r\n    var _data = DogCan.Forum.Category.Data;\r\n    var html = {};\r\n\r\n    var setupHtml = function () {\r\n        html['latest'] = $('.categoryList .latest_');\r\n        html['team'] = $('.categoryList .team_');\r\n\r\n        html['latest'].addClass(_data.css.actived);\r\n    };\r\n\r\n    var setupFunc = function () {\r\n        var css_actived = _data.css.actived;\r\n        html['latest'].click(function () {\r\n            html['latest'].addClass(css_actived);\r\n            html['team'].removeClass(css_actived);\r\n        });\r\n        html['team'].click(function () {\r\n            html['team'].addClass(css_actived);\r\n            html['latest'].removeClass(css_actived);\r\n        });\r\n    };\r\n\r\n    var _init = function () {\r\n        setupHtml();\r\n        setupFunc();\r\n    };\r\n    _init();\r\n};\r\n\r\nwindow.DogCan.Forum.Category.Data = {\r\n    css: {\r\n        actived: 'actived'\r\n    }\r\n};\r\n","window.DogCan = window.DogCan || {};\r\nwindow.DogCan.Forum = window.DogCan.Forum || {};\r\n\r\n// manage forum list\r\nwindow.DogCan.Forum.List = function () {\r\n    var that = this;\r\n    var _data = DogCan.Forum.List.Data;\r\n\r\n    var html = {};\r\n    var topics = [];\r\n    var count = 0;\r\n\r\n    // load from server\r\n    this.load = function () {\r\n        $.ajax({\r\n            url: _data.url.list + count,\r\n            success: function (data) {\r\n                if (data == null) {\r\n                    html['loading'].hide();\r\n                    html['end'].show();\r\n                    return;\r\n                }\r\n                if (data.length < _data.queryCount) {\r\n                    html['loading'].hide();\r\n                    html['end'].show();\r\n                }\r\n                var l = data.length;\r\n                for (var i = 0; i < l; i++) {\r\n                    topics.push(data[i]);\r\n                }\r\n                render();\r\n            }\r\n        })\r\n    };\r\n\r\n    // load topic data\r\n    this.loadData = function (items) {\r\n        if (items == null) return;\r\n        var l = items.length;\r\n        for (var i = 0; i < l; i++) {\r\n            topics.push(items[i]);\r\n        }\r\n        render();\r\n    }\r\n\r\n    // render new topics to screen\r\n    var render = function () {\r\n        for (var l = topics.length; count < l; count++) {\r\n            createTopic(topics[count]);\r\n        }\r\n    };\r\n\r\n    var createTopic = function (topicData) {\r\n        var id = topicData.id;\r\n        var title = topicData.title;\r\n        var category = topicData.category;\r\n        var reply = topicData.reply;\r\n        var view = topicData.view;\r\n        var lastTime = topicData.lastTime;\r\n        var firstTime = topicData.firstTime;\r\n        var author = topicData.author;\r\n        var user = topicData.user || [];\r\n\r\n        var item = $(_data.html.item);\r\n        item.children('.category_').text(category);\r\n        item.find('.title_ a').text(title).attr('href', _data.url.post + id);\r\n        item.children('.reply_').text(reply).attr('title', _data.text.reply.replace('#reply#', reply).replace('#view#', view));\r\n        item.children('.activity_').text(lastTime).attr('title', _data.text.activity.replace('#firstTime#', firstTime).replace('#lastTime#', lastTime));\r\n\r\n        var portrait = $(_data.html.portrait).attr('href', _data.url.user + author.id).appendTo(item.children('.user_'))\r\n        portrait.children('img').attr('src', '/image/portrait/' + author.portrait);\r\n        portrait.tip(author.name);\r\n        for (var i = 0, l = user.length; i < l; i++) {\r\n            portrait = $(_data.html.portrait).attr('href', _data.url.user + user[i].id).appendTo(item.children('.user_'));\r\n            portrait.children('img').attr('src', '/image/portrait/' + user[i].portrait);\r\n            portrait.tip(user[i].name);\r\n        }\r\n        $(_data.html.clear).appendTo(item.children('.user_'));\r\n        item.appendTo(html['content']);\r\n    };\r\n\r\n    // setup function\r\n    var setupHtml = function () {\r\n        html['container'] = $('.topicList');\r\n        html['header'] = {};\r\n        html['header']['category'] = html['container'].children('.header_ .category_');\r\n        html['header']['title'] = html['container'].children('.header_ .title_');\r\n        html['header']['user'] = html['container'].children('.header_ .user_');\r\n        html['header']['reply'] = html['container'].children('.header_ .reply_');\r\n        html['header']['activity'] = html['container'].children('.header_ .activity_');\r\n\r\n        html['content'] = html['container'].children('.content_');\r\n        html['end'] = $('.topicEnd').hide();\r\n        html['loading'] = $('.topicLoading');\r\n    };\r\n\r\n    var setupFunc = function () {\r\n    };\r\n\r\n    var _init = function () {\r\n        setupHtml();\r\n        setupFunc();\r\n    };\r\n    _init();\r\n};\r\n\r\nwindow.DogCan.Forum.List.Data = {\r\n    html: {\r\n        item: '<tr>' +\r\n                    '<td class=\"title_\"><a></a></td>' +\r\n                    '<td class=\"category_\"></td>' +\r\n                    '<td class=\"user_\"></td>' +\r\n                    '<td class=\"reply_\"></td>' +\r\n                    '<td class=\"activity_\"></td>' +\r\n                '</tr>',\r\n        portrait: '<a class=\"portrait_\" target=\"_blank\"><img width=\"25\" height=\"25\"/></a>',\r\n        clear: '<div class=\"clear\"></div>'\r\n    },\r\n    text: {\r\n        reply: '回复数: #reply#\\r\\n观看数: #view#',\r\n        activity: '立帖时间: #firstTime#\\r\\n最新回复: #lastTime#'\r\n    },\r\n    url: {\r\n        list: '/forum/topic/',\r\n        post: DogCan.Url.Post+'/',\r\n        user: DogCan.Url.User + '/'\r\n    },\r\n    queryCount: 10\r\n};"],"sourceRoot":"/source/"}