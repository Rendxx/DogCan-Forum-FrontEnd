{"version":3,"sources":["manager.js","category.js","list.js"],"names":["window","DogCan","Forum","Manager","opts_in","html","category","list","initList","topic","loadData","setupHtml","$","setupComponent","Category","List","setupLayout","$$","scroll","set","addClass","REFERENCE","TOP","DIRECTION","DOWN","removeClass","UP","load","BOTTOM","_init","opts","_data","Data","css","actived","setupFunc","css_actived","click","topics","count","this","ajax","url","success","data","hide","show","length","queryCount","l","i","push","render","items","createTopic","topicData","id","title","reply","view","lastTime","firstTime","author","user","item","children","text","find","attr","post","replace","activity","portrait","appendTo","tip","name","clear"],"mappings":"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","file":"forum.min.js","sourcesContent":["window.DogCan = window.DogCan || {};\r\nwindow.DogCan.Forum = window.DogCan.Forum || {};\r\n\r\nwindow.DogCan.Forum.Manager = function (opts_in) {\r\n    var that = this;\r\n    var html = {};\r\n\r\n    // component\r\n    var category = null;\r\n    var list = null;\r\n\r\n    var initList = function (topic) {\r\n        list.loadData(topic);\r\n    };\r\n\r\n    // setup\r\n    var setupHtml = function () {\r\n        html['header'] = $('.block-header');\r\n        html['category'] = $('.block-category');\r\n        html['list'] = $('.block-list');\r\n        html['listLoading'] = $('.block-list .topicLoading');\r\n    };\r\n\r\n    var setupComponent = function () {\r\n        category = new DogCan.Forum.Category();\r\n        list = new DogCan.Forum.List();\r\n    };\r\n\r\n    var setupLayout = function () {\r\n        $$.scroll.set(html['category'][0], 200, function () {\r\n            html['header'].addClass('small_');\r\n        }, $$.scroll.REFERENCE.TOP, $$.scroll.DIRECTION.DOWN);\r\n\r\n        $$.scroll.set(html['category'][0], 200, function () {\r\n            html['header'].removeClass('small_');\r\n        }, $$.scroll.REFERENCE.TOP, $$.scroll.DIRECTION.UP);\r\n\r\n        $$.scroll.set(html['listLoading'][0], 20, function () {\r\n            list && list.load();\r\n        }, $$.scroll.REFERENCE.BOTTOM, $$.scroll.DIRECTION.DOWN);\r\n    };\r\n\r\n    var _init = function (opts) {\r\n        setupHtml();\r\n        setupLayout();\r\n        setupComponent();\r\n\r\n        if (opts == null) return;\r\n        initList(opts.topic);\r\n    };\r\n    _init(opts_in);\r\n};","window.DogCan = window.DogCan || {};\r\nwindow.DogCan.Forum = window.DogCan.Forum || {};\r\n\r\n// manage forum category\r\nwindow.DogCan.Forum.Category = function () {\r\n    var that = this;\r\n    var _data = DogCan.Forum.Category.Data;\r\n    var html = {};\r\n\r\n    var setupHtml = function () {\r\n        html['latest'] = $('.categoryList .latest_');\r\n        html['team'] = $('.categoryList .team_');\r\n\r\n        html['latest'].addClass(_data.css.actived);\r\n    };\r\n\r\n    var setupFunc = function () {\r\n        var css_actived = _data.css.actived;\r\n        html['latest'].click(function () {\r\n            html['latest'].addClass(css_actived);\r\n            html['team'].removeClass(css_actived);\r\n        });\r\n        html['team'].click(function () {\r\n            html['team'].addClass(css_actived);\r\n            html['latest'].removeClass(css_actived);\r\n        });\r\n    };\r\n\r\n    var _init = function () {\r\n        setupHtml();\r\n        setupFunc();\r\n    };\r\n    _init();\r\n};\r\n\r\nwindow.DogCan.Forum.Category.Data = {\r\n    css: {\r\n        actived: 'actived'\r\n    }\r\n};\r\n","window.DogCan = window.DogCan || {};\r\nwindow.DogCan.Forum = window.DogCan.Forum || {};\r\n\r\n// manage forum list\r\nwindow.DogCan.Forum.List = function () {\r\n    var that = this;\r\n    var _data = DogCan.Forum.List.Data;\r\n\r\n    var html = {};\r\n    var topics = [];\r\n    var count = 0;\r\n\r\n    // load from server\r\n    this.load = function () {\r\n        $.ajax({\r\n            url: _data.url.list + count,\r\n            success: function (data) {\r\n                if (data == null) {\r\n                    html['loading'].hide();\r\n                    html['end'].show();\r\n                    return;\r\n                }\r\n                if (data.length < _data.queryCount) {\r\n                    html['loading'].hide();\r\n                    html['end'].show();\r\n                }\r\n                var l = data.length;\r\n                for (var i = 0; i < l; i++) {\r\n                    topics.push(data[i]);\r\n                }\r\n                render();\r\n            }\r\n        })\r\n    };\r\n\r\n    // load topic data\r\n    this.loadData = function (items) {\r\n        if (items == null) return;\r\n        var l = items.length;\r\n        for (var i = 0; i < l; i++) {\r\n            topics.push(items[i]);\r\n        }\r\n        render();\r\n    }\r\n\r\n    // render new topics to screen\r\n    var render = function () {\r\n        for (var l = topics.length; count < l; count++) {\r\n            createTopic(topics[count]);\r\n        }\r\n    };\r\n\r\n    var createTopic = function (topicData) {\r\n        var id = topicData.id;\r\n        var title = topicData.title;\r\n        var category = topicData.category;\r\n        var reply = topicData.reply;\r\n        var view = topicData.view;\r\n        var lastTime = topicData.lastTime;\r\n        var firstTime = topicData.firstTime;\r\n        var author = topicData.author;\r\n        var user = topicData.user || [];\r\n\r\n        var item = $(_data.html.item);\r\n        item.children('.category_').text(category);\r\n        item.find('.title_ a').text(title).attr('href', _data.url.post + id);\r\n        item.children('.reply_').text(reply).attr('title', _data.text.reply.replace('#reply#', reply).replace('#view#', view));\r\n        item.children('.activity_').text(lastTime).attr('title', _data.text.activity.replace('#firstTime#', firstTime).replace('#lastTime#', lastTime));\r\n\r\n        var portrait = $(_data.html.portrait).attr('href', _data.url.user + author.id).appendTo(item.children('.user_'))\r\n        portrait.children('img').attr('src', '/image/portrait/' + author.portrait);\r\n        portrait.tip(author.name);\r\n        for (var i = 0, l = user.length; i < l; i++) {\r\n            portrait = $(_data.html.portrait).attr('href', _data.url.user + user[i].id).appendTo(item.children('.user_'));\r\n            portrait.children('img').attr('src', '/image/portrait/' + user[i].portrait);\r\n            portrait.tip(user[i].name);\r\n        }\r\n        $(_data.html.clear).appendTo(item.children('.user_'));\r\n        item.appendTo(html['content']);\r\n    };\r\n\r\n    // setup function\r\n    var setupHtml = function () {\r\n        html['container'] = $('.topicList');\r\n        html['header'] = {};\r\n        html['header']['category'] = html['container'].children('.header_ .category_');\r\n        html['header']['title'] = html['container'].children('.header_ .title_');\r\n        html['header']['user'] = html['container'].children('.header_ .user_');\r\n        html['header']['reply'] = html['container'].children('.header_ .reply_');\r\n        html['header']['activity'] = html['container'].children('.header_ .activity_');\r\n\r\n        html['content'] = html['container'].children('.content_');\r\n        html['end'] = $('.topicEnd').hide();\r\n        html['loading'] = $('.topicLoading');\r\n    };\r\n\r\n    var setupFunc = function () {\r\n    };\r\n\r\n    var _init = function () {\r\n        setupHtml();\r\n        setupFunc();\r\n    };\r\n    _init();\r\n};\r\n\r\nwindow.DogCan.Forum.List.Data = {\r\n    html: {\r\n        item: '<tr>' +\r\n                    '<td class=\"title_\"><a></a></td>' +\r\n                    '<td class=\"category_\"></td>' +\r\n                    '<td class=\"user_\"></td>' +\r\n                    '<td class=\"reply_\"></td>' +\r\n                    '<td class=\"activity_\"></td>' +\r\n                '</tr>',\r\n        portrait: '<a class=\"portrait_\" target=\"_blank\"><img width=\"25\" height=\"25\"/></a>',\r\n        clear: '<div class=\"clear\"></div>'\r\n    },\r\n    text: {\r\n        reply: '回复数: #reply#\\r\\n观看数: #view#',\r\n        activity: '立帖时间: #firstTime#\\r\\n最新回复: #lastTime#'\r\n    },\r\n    url: {\r\n        list: '/forum/topic/',\r\n        post: '/forum/post/',\r\n        user: '/user/'\r\n    },\r\n    queryCount: 10\r\n};"],"sourceRoot":"/source/"}